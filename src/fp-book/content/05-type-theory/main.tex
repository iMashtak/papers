\chapter{Теория типов}

Текст данного раздела базируется на монографии \cite{Pierce}.

\section{Чистое простое типизированное $\lambda$-исчисление}

Утверждение <<терм $t$ имеет тип $T$>> означает, что $t$ <<очевидным образом>> даёт при вычислении значение нужного вида, при этом под словами <<очевидным образом>> подразумевается, что проверить это можно статически, не производя самого вычисления $t$. Отношение типизации будем записывать следующим образом: $t: T$.

В случае объектов-значений им можно присваивать произвольные типы-значения. Например, в $\lambda$-исчисление можно погрузить булеву алгебру со значениями $true: Bool$, $false: Bool$. Функции же типизируются при помощи конструктора типов $\to$. Например, $\lambda$-абстракция $\lambda x.x$ имеет тип $T \to T$, то есть принимает значение любого типа и возвращает значение строго этого же типа. Символ $T$ в данном случае обозначает типовую переменную. Конструктор типов право-ассоциативен, то есть выражение $T_1 \to T_2 \to T_3$ обозначает $T_1 \to (T_2 \to T_3)$.

\begin{definition}
    Контекст типизации $\Gamma$ представляет собой множество переменных/термов вместе с известными для них типами.
\end{definition}

Таким образом можно записать правила типизации чистого $\lambda$- исчисления:

\begin{itemize}
    \item $\cfrac{x:T \in \Gamma}{\Gamma \vdash x:T}$
    \item $\cfrac{\Gamma,x: T_1\vdash t: T_2}{\Gamma \vdash \lambda x:T_1.t: T_1 \to T_2}$
    \item $\cfrac{\Gamma \vdash t_1: T_1 \to T_2 \ \ \ \Gamma \vdash t_2 : T_1}{\Gamma \vdash t_1t_2:T_2}$
\end{itemize}

Первое правило вывода говорит о том, что если в контексте типизации уже определён тип некоторой переменной или терма, то он остаётся в силе и в других местах использования этой переменной или терма. Второе правило вводит конструктор типов, третье правило же вводит способ сокращения типа.

Используя правила вывода в обратную сторону можно строить деревья вывода типа.

\begin{theorem}
    В любом заданном контексте типизации $\Gamma$ терм $t$ имеет не более одного типа. Более того, существует только одно дерево вывода.
\end{theorem}

\begin{theorem}
    Пусть $t$ --- замкнутый, типизированный терм (то есть $t:T$). Тогда либо $t$ является значением, либо имеется терм $t'$ такой, что $t$ возможно редуцировать до $t'$.
\end{theorem}

\begin{theorem}
    Пусть $\Gamma \vdash t:T$ и для $x$ не определён тип в контексте $\Gamma$. Тогда $\Gamma, x: S \vdash t: T$. Более того, глубина дерева вывода остаётся неизменной.
\end{theorem}

\begin{theorem}
    Если $\Gamma, x:S\vdash t: T$ и $\Gamma \vdash s: S$, то $\Gamma \vdash [s/x]t: T$. То есть тип сохраняется при подстановке переменной того же типа, что есть в терме $t$.
\end{theorem}

TODO: вывод типов комбинаторов S и K

\section{Соответствие Карри-Говарда}

Соответствие Карри-Говарда описывает в установлении взаимосвязи между множеством формул логического исчисления и системой типов. Так в случае чистого простого типизированного $\lambda$-исчисления соответствующим исчислением будет позитивное интуиционистское исчисление высказываний (позитивное --- значит без отрицания).

Соответствие состоит в следующем:

\begin{equation*}
    \begin{array}{rl}
        \text{утверждения} & \text{типы} \\
        \text{утверждение }p \supset q & \text{тип } P \to Q \\
        \text{доказательство утверждения }T & \text{терм }t \text{ типа }T \\ 
        \text{утверждение }T \text{ доказуемо} & \text{существуют термы типа }T
    \end{array}
\end{equation*}

Таким образом представляется возможным доказывать утверждения путём конструирования терма соответствующего типа.

TODO пример с комбинатором I

\input{content/05-type-theory/tasks}